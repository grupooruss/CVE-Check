import argparse
import socket

def check_vulnerability(host, port):
    try:
        # Intentamos conectarnos al host y puerto especificados
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        s.settimeout(1)  # Establecemos un tiempo de espera para la conexión
        s.connect((host, port))
        print(f"El sistema en {host}:{port} podría ser vulnerable.")
    except Exception as e:
        print(f"El sistema en {host}:{port} no parece ser vulnerable.")
    finally:
        s.close()

# Parseamos los argumentos de la línea de comandos
parser = argparse.ArgumentParser(description='Script para verificar la vulnerabilidad a un CVE.')
parser.add_argument('host', type=str, help='La dirección IP o nombre de dominio del sistema a verificar.')
parser.add_argument('port', type=int, help='El puerto donde se ejecuta el servicio vulnerable.')

args = parser.parse_args()

# Verificamos la vulnerabilidad usando los argumentos proporcionados
check_vulnerability(args.host, args.port)
